/*! mvc-framework 2014-04-25 */
function Model(){var a=new Controller(this);this.controller=a}function View(){}function Controller(a){this.model=a}function initializeCollection(a,b,c){for(var d=getCollectionObject(b,c.model.getData()),e=a.ownerDocument.createDocumentFragment(),f=0;f<d.length;f++){for(var g=a.cloneNode(!0),h=mvc.getNodeList(g,".//@mvc-bind/.."),i=0;i<h.length;i++)h[i].getAttribute("mvc-bind")&&initializeValue(h[i],h[i].getAttribute("mvc-bind"),c,d[f]);e.appendChild(g)}a.parentNode.appendChild(e),a.style.display="none"}function getCollectionObject(a,b){for(var c=a.split("."),d=0;d<c.length;d++)b=b[c[d]];return b}function initializeValue(a,b,c,d){var e=d||c.model.getData();b=mvc.getArrOfBindingProperties(b);for(var f=b.length,g=0;f>g;g++){var h=b[g].objectProperty;if(e.hasOwnProperty(h)){var i=e[h]();"text"==b[g].nodeProperty?a.textContent=i:a.setAttribute(b[g].nodeProperty,i),addViewListeners(a,e,b[g].objectProperty)}else e[h]=createObservable(null,c)}}function addViewListeners(a,b,c){var d=a.nodeName.toLowerCase();("input"==d||"select"==d||"textarea"==d)&&mvc.addEventListener(a,"input",onInputHandler(b,c))}function onInputHandler(a,b){return function(c){a[b](getSrcElement(c).value)}}function initializeObservablesForDataObject(a){dataObject=a.model.getData(),dataObject&&mapObjectByFields(dataObject,a)}function mapObjectByFields(a,b){for(var c in a)a.hasOwnProperty(c)&&("object"==typeof a[c]?mapObjectByFields(a[c],b):a[c]=createObservable(a[c],b))}function createObservable(a,b){return function(c){return"undefined"!=typeof c&&(a=c,b.reBindDataToView()),a}}window.model=new Model,Model.prototype.getData=function(){return this.data},Model.prototype.initializeModel=function(a){this.data=a,this.controller.initializeView(a)},Model.prototype.setData=function(a){this.data=a},Controller.prototype.initializeView=function(){initializeObservablesForDataObject(this),this.reBindDataToView()},Controller.prototype.reBindDataToView=function(){for(var a=0;a<nodeList.length;a++){currentNode=nodeList[a];for(var b=mvc.getNodeList(currentNode,"@*[starts-with(name(.),'mvc')]"),c=0;c<b.length;c++){var d=b[0].nodeName,e=b[0].nodeValue;"mvc-bind"==d?e&&initializeValue(currentNode,e,this):"mvc-repeat"==d&&initializeCollection(currentNode,e,this)}}},function(a){function b(){document.documentElement;a.nodeList=a.mvc.getNodeList(document.documentElement,".//*//*[not(@mvc-repeat)]/*/@*[starts-with(name(.),'mvc')]/.. | .//*[@mvc-repeat]")}function c(){this.getNodeList=function(a,b){for(var c=document.evaluate(b,a,null,XPathResult.ANY_TYPE,null),d=c.iterateNext(),e=[];d;)e[e.length]=d,d=c.iterateNext();return e},this.addEventListener=function(a,b,c){var d=a.ownerDocument||a;d.addEventListener?a.addEventListener(b,c,!1):a.attachEvent("on"+b,c)},this.getSrcElement=function(a){return a.srcElement||a.target},this.getArrOfBindingProperties=function(a){for(var b=a.split(","),c=new Array(b.length),d=0;d<b.length;d++){c[d]={};var e=b[d].split(":");c[d].nodeProperty=e[0].trim(),c[d].objectProperty=e[1].trim()}return c}}a.mvc=new c,a.mvc.addEventListener(a.document,"DOMContentLoaded",b)}(window);